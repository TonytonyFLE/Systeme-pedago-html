<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎉 Birthday Party Games - 28th Birthday 🎂</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
            background-size: 400% 400%;
            animation: gradientShift 8s ease infinite;
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-top: 20px;
            backdrop-filter: blur(10px);
        }
        
        h1 {
            text-align: center;
            color: #ff6b6b;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            font-weight: 700;
        }
        
        .game-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .game-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 25px;
            color: white;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            text-align: center;
        }
        
        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }
        
        .game-card h3 {
            font-size: 1.4em;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .game-card p {
            font-size: 0.95em;
            opacity: 0.9;
        }
        
        .game-screen {
            display: none;
        }
        
        .game-screen.active {
            display: block;
        }
        
        .section {
            background: rgba(255, 255, 255, 0.9);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border: 1px solid #e0e0e0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .section h3 {
            color: #4ecdc4;
            margin-bottom: 15px;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        input, select, button, textarea {
            padding: 12px 16px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            margin: 5px;
            font-family: inherit;
        }
        
        button {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        button:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        button:active {
            transform: scale(0.98);
        }
        
        .back-button {
            background: linear-gradient(45deg, #636e72, #2d3436);
            margin-bottom: 20px;
        }
        
        .players-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .player-tag {
            background: linear-gradient(45deg, #96ceb4, #45b7d1);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .remove-player {
            background: rgba(255,255,255,0.3);
            border: none;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            padding: 0;
            margin: 0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }
        
        .secret-section {
            background: linear-gradient(45deg, #ffeaa7, #fab1a0);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border: 3px dashed #e17055;
        }
        
        .rule-hidden {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-style: italic;
            color: #666;
        }
        
        .rule-revealed {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #4caf50;
        }
        
        .word-history {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .word-item {
            display: inline-block;
            background: #e3f2fd;
            padding: 8px 12px;
            border-radius: 15px;
            margin: 3px;
            border: 2px solid transparent;
            font-weight: 500;
        }
        
        .word-item.correct {
            background: #c8e6c9;
            border-color: #4caf50;
        }
        
        .word-item.incorrect {
            background: #ffcdd2;
            border-color: #f44336;
        }
        
        .scoreboard {
            background: linear-gradient(45deg, #a29bfe, #6c5ce7);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .score-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            font-weight: 500;
        }
        
        .current-player {
            background: rgba(255, 255, 255, 0.3) !important;
            font-weight: 700;
            box-shadow: 0 0 15px rgba(255,255,255,0.3);
        }
        
        .character-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .character-card {
            background: white;
            border: 3px solid #ddd;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .character-card:hover {
            border-color: #4ecdc4;
            transform: scale(1.05);
        }
        
        .character-card.selected {
            border-color: #ff6b6b;
            background: #ffe6e6;
        }
        
        .character-card.revealed {
            border-color: #4caf50;
            background: #e8f5e8;
        }
        
        .question-display {
            background: linear-gradient(45deg, #74b9ff, #0984e3);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            font-size: 1.2em;
            margin: 20px 0;
            font-weight: 500;
        }
        
        .counting-display {
            background: linear-gradient(45deg, #fd79a8, #e84393);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            font-size: 2em;
            margin: 20px 0;
            font-weight: 700;
        }
        
        .rules-list {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border: 2px solid #ffeaa7;
        }
        
        .rule-item {
            background: white;
            padding: 10px 15px;
            margin: 8px 0;
            border-radius: 8px;
            border-left: 4px solid #ff6b6b;
            font-weight: 500;
        }
        
        .game-input {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .game-input input {
            flex: 1;
            font-size: 18px;
            padding: 15px;
            min-width: 200px;
        }
        
        .hint-box {
            background: linear-gradient(45deg, #fdcb6e, #e17055);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
            font-weight: 500;
        }
        
        .hint-box.show {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #ff6b6b;
            animation: confetti-fall 3s linear infinite;
        }
        
        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                padding: 15px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .game-input {
                flex-direction: column;
            }
            
            .game-input input {
                min-width: unset;
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🎉 Birthday Party Games 🎂</h1>

        <!-- Main Menu -->
        <div id="mainMenu" class="game-screen active">
            <div class="game-menu">
                <div class="game-card" onclick="showGame('findRule')" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <h3>🔍 Find the Rule</h3>
                    <p>One player knows a secret rule. Others must guess it by submitting words!</p>
                </div>
                
                <div class="game-card" onclick="showGame('whoAmI')" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <h3>🎭 Who Am I?</h3>
                    <p>Guess the famous character by asking yes/no questions!</p>
                </div>
                
                <div class="game-card" onclick="showGame('truthDare')" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                    <h3>🎯 Truth or Dare</h3>
                    <p>Classic party game with fun truths and creative dares!</p>
                </div>
                
                <div class="game-card" onclick="showGame('countingGame')" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                    <h3>🔢 Counting Challenge</h3>
                    <p>Count to 10 together, but watch out for the rules that get added!</p>
                </div>
            </div>
        </div>
        
        <!-- Find the Rule Game -->
        <div id="findRuleGame" class="game-screen">
            <button class="back-button" onclick="showGame('main')">← Back to Menu</button>
            
            <div id="findRuleSetup">
                <div class="section">
                    <h3>👥 Players Setup</h3>
                    <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                        <input type="text" id="playerName" placeholder="Player name" maxlength="20">
                        <button onclick="addPlayer('findRule')">Add Player</button>
                    </div>
                    <div class="players-list" id="findRulePlayersList"></div>
                </div>
                
                <div class="secret-section">
                    <h3>🤫 For Game Master Only</h3>
                    <p><strong>Select a rule secretly:</strong></p>
                    <select id="ruleSelector">
                        <option value="">Choose a rule...</option>
                        <option value="double-letter">Words must contain double letters (effect, balloon)</option>
                        <option value="alphabet-order">Each word starts with next alphabet letter (apple → banana → cat)</option>
                        <option value="increasing-length">Each word has one more letter than previous</option>
                        <option value="vowel-a">All words must contain the letter 'A'</option>
                        <option value="no-e">No words can contain the letter 'E'</option>
                        <option value="animals">Only animal names allowed</option>
                        <option value="rhyme">Each word must rhyme with the previous one</option>
                    </select>
                    <button onclick="changeGameMaster()" style="background: linear-gradient(45deg, #e17055, #fdcb6e); margin-top: 10px;">
                        🔄 Change Game Master
                    </button>
                </div>
                
                <button onclick="startFindRuleGame()" style="width: 100%; padding: 15px; font-size: 18px; margin-top: 20px;">
                    🚀 Start Game!
                </button>
            </div>
            
            <div id="findRuleGameplay" style="display: none;">
                <div class="scoreboard">
                    <h3>🏆 Scoreboard</h3>
                    <div id="findRuleScores"></div>
                </div>
                
                <div class="section">
                    <h3>🎮 Current Player: <span id="findRuleCurrentPlayer"></span></h3>
                    <div class="game-input">
                        <input type="text" id="findRuleWordInput" placeholder="Enter your word..." onkeypress="handleFindRuleKeyPress(event)">
                        <button onclick="submitFindRuleWord()">Submit</button>
                        <button onclick="giveFindRuleHint()">💡 Hint</button>
                    </div>
                </div>
                
                <div class="hint-box" id="findRuleHintBox"></div>
                
                <div class="section">
                    <h3>📝 Word History</h3>
                    <div class="word-history" id="findRuleWordHistory"></div>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button onclick="revealFindRuleRule()" style="background: linear-gradient(45deg, #e17055, #fdcb6e);">
                        🎭 Reveal Rule
                    </button>
                    <button onclick="resetFindRuleGame()" style="background: linear-gradient(45deg, #636e72, #2d3436);">
                        🔄 New Game
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Who Am I Game -->
        <div id="whoAmIGame" class="game-screen">
            <button class="back-button" onclick="showGame('main')">← Back to Menu</button>
            
            <div id="whoAmISetup">
                <div class="section">
                    <h3>👥 Players Setup</h3>
                    <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                        <input type="text" id="whoAmIPlayerName" placeholder="Player name" maxlength="20">
                        <button onclick="addPlayer('whoAmI')">Add Player</button>
                    </div>
                    <div class="players-list" id="whoAmIPlayersList"></div>
                </div>
                
                <button onclick="startWhoAmIGame()" style="width: 100%; padding: 15px; font-size: 18px; margin-top: 20px;">
                    🎭 Start Who Am I!
                </button>
            </div>
            
            <div id="whoAmIGameplay" style="display: none;">
                <div class="section">
                    <h3>🎯 Current Player: <span id="whoAmICurrentPlayer"></span></h3>
                    <p>Pick a character for <strong><span id="whoAmICurrentPlayerRepeat"></span></strong> to guess:</p>
                    <div class="character-grid" id="characterGrid"></div>
                    <button onclick="confirmCharacter()" id="confirmCharacterBtn" style="display: none; width: 100%; margin-top: 15px;">
                        ✅ Confirm Selection
                    </button>
                </div>
                
                <div id="guessingPhase" style="display: none;">
                    <div class="section">
                        <h3><span id="guessingPlayerName"></span> is guessing their character!</h3>
                        <p>Ask yes/no questions to figure out who you are!</p>
                        <div style="text-align: center; margin: 20px 0;">
                            <button onclick="revealWhoAmICharacter()" style="background: linear-gradient(45deg, #e17055, #fdcb6e);">
                                🎭 Give up / Reveal Character
                            </button>
                            <button onclick="whoAmICorrectGuess()" style="background: linear-gradient(45deg, #00b894, #55a3ff);">
                                ✅ Guessed Correctly!
                            </button>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button onclick="nextWhoAmIPlayer()" id="nextPlayerBtn" style="display: none;">
                        ➡️ Next Player
                    </button>
                    <button onclick="resetWhoAmIGame()" style="background: linear-gradient(45deg, #636e72, #2d3436);">
                        🔄 New Game
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Truth or Dare Game -->
        <div id="truthDareGame" class="game-screen">
            <button class="back-button" onclick="showGame('main')">← Back to Menu</button>
            
            <div id="truthDareSetup">
                <div class="section">
                    <h3>👥 Players Setup</h3>
                    <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                        <input type="text" id="truthDarePlayerName" placeholder="Player name" maxlength="20">
                        <button onclick="addPlayer('truthDare')">Add Player</button>
                    </div>
                    <div class="players-list" id="truthDarePlayersList"></div>
                </div>
                
                <button onclick="startTruthDareGame()" style="width: 100%; padding: 15px; font-size: 18px; margin-top: 20px;">
                    🎯 Start Truth or Dare!
                </button>
            </div>
            
            <div id="truthDareGameplay" style="display: none;">
                <div class="section">
                    <h3>🎮 Current Player: <span id="truthDareCurrentPlayer"></span></h3>
                    <div style="text-align: center; margin: 20px 0;">
                        <button onclick="chooseTruth()" style="background: linear-gradient(45deg, #74b9ff, #0984e3); padding: 15px 30px; font-size: 18px; margin: 10px;">
                            💭 Truth
                        </button>
                        <button onclick="chooseDare()" style="background: linear-gradient(45deg, #fd79a8, #e84393); padding: 15px 30px; font-size: 18px; margin: 10px;">
                            🎯 Dare
                        </button>
                    </div>
                </div>
                
                <div class="question-display" id="truthDareQuestion" style="display: none;"></div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button onclick="nextTruthDarePlayer()" id="nextTruthDareBtn" style="display: none;">
                        ➡️ Next Player
                    </button>
                    <button onclick="resetTruthDareGame()" style="background: linear-gradient(45deg, #636e72, #2d3436);">
                        🔄 New Game
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Counting Game -->
        <div id="countingGame" class="game-screen">
            <button class="back-button" onclick="showGame('main')">← Back to Menu</button>
            
            <div id="countingSetup">
                <div class="section">
                    <h3>👥 Players Setup</h3>
                    <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                        <input type="text" id="countingPlayerName" placeholder="Player name" maxlength="20">
                        <button onclick="addPlayer('counting')">Add Player</button>
                    </div>
                    <div class="players-list" id="countingPlayersList"></div>
                </div>
                
                <div class="section">
                    <h3>📋 How to Play</h3>
                    <p>Players take turns counting from 1 to 10. When someone reaches 10, they add a new rule from 3 options. Everyone must follow all active rules!</p>
                </div>
                
                <button onclick="startCountingGame()" style="width: 100%; padding: 15px; font-size: 18px; margin-top: 20px;">
                    🔢 Start Counting!
                </button>
            </div>
            
            <div id="countingGameplay" style="display: none;">
                <div class="counting-display">
                    Current Number: <span id="currentNumber">1</span>
                </div>
                
                <div class="section">
                    <h3>🎮 Current Player: <span id="countingCurrentPlayer"></span></h3>
                    <div style="text-align: center; margin: 20px 0;">
                        <button onclick="sayNumber()" style="padding: 15px 30px; font-size: 18px;">
                            🔢 Say the Number
                        </button>
                    </div>
                </div>
                
                <div class="rules-list" id="activeRules">
                    <h4>📋 Active Rules:</h4>
                    <div class="rule-item">Count from 1 to 10</div>
                </div>
                
                <div id="ruleSelection" style="display: none;">
                    <div class="section">
                        <h3>🎉 You reached 10! Choose a new rule:</h3>
                        <div id="ruleOptions"></div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button onclick="resetCountingGame()" style="background: linear-gradient(45deg, #636e72, #2d3436);">
                        🔄 New Game
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="celebration" id="celebration"></div>

    <script>
        // Global variables for all games
        let currentGame = 'main';
        
        // Find the Rule Game Variables
        let findRulePlayers = [];
        let findRuleCurrentPlayerIndex = 0;
        let findRuleScores = {};
        let findRuleWordHistory = [];
        let findRuleSelectedRule = null;
        let findRuleHintCount = 0;
        
        // Who Am I Game Variables
        let whoAmIPlayers = [];
        let whoAmICurrentPlayerIndex = 0;
        let whoAmISelectedCharacter = '';
        let whoAmICurrentCharacter = '';
        
        // Truth or Dare Variables
        let truthDarePlayers = [];
        let truthDareCurrentPlayerIndex = 0;
        
        // Counting Game Variables
        let countingPlayers = [];
        let countingCurrentPlayerIndex = 0;
        let currentCount = 1;
        let countingRules = ['Count from 1 to 10'];
        
        // Famous characters for Who Am I
        const characters = [
            'Harry Potter', 'Superman', 'Batman', 'Spider-Man', 'Wonder Woman',
            'Mickey Mouse', 'Albert Einstein', 'Leonardo da Vinci', 'Shakespeare',
            'Michael Jackson', 'Elvis Presley', 'Madonna', 'Lady Gaga', 'Beyoncé',
            'Tom Cruise', 'Brad Pitt', 'Angelina Jolie', 'Will Smith', 'Jennifer Lawrence',
            'Elon Musk', 'Bill Gates', 'Steve Jobs', 'Mark Zuckerberg', 'Jeff Bezos',
            'Oprah Winfrey', 'Ellen DeGeneres', 'Gordon Ramsay', 'Jamie Oliver',
            'Cristiano Ronaldo', 'Lionel Messi', 'LeBron James', 'Serena Williams',
            'Marilyn Monroe', 'Audrey Hepburn', 'Charlie Chaplin', 'Walt Disney',
            'Pablo Picasso', 'Vincent van Gogh', 'Frida Kahlo', 'Andy Warhol',
            'Nelson Mandela', 'Martin Luther King Jr.', 'Mahatma Gandhi', 'Mother Teresa',
            'Donald Trump', 'Barack Obama', 'Queen Elizabeth II', 'Princess Diana',
            'Iron Man', 'Captain America', 'Thor', 'Hulk', 'Black Widow',
            'Sherlock Holmes', 'James Bond', 'Indiana Jones', 'Luke Skywalker', 'Darth Vader'
        ];
        
        // Truth questions
        const truthQuestions = [
            "What's the most embarrassing thing you've ever done?",
            "What's your biggest fear?",
            "What's the weirdest dream you've ever had?",
            "What's your most useless talent?",
            "What's the worst fashion trend you ever followed?",
            "What's your guilty pleasure TV show/movie?",
            "What's the most childish thing you still do?",
            "What's your worst habit?",
            "What's the last lie you told?",
            "What's your biggest pet peeve?",
            "What's the strangest food combination you enjoy?",
            "What's your most irrational fear?",
            "What's the most trouble you've ever been in?",
            "What's your worst dating experience?",
            "What's the most expensive thing you've broken?",
            "What's your secret that nobody knows?",
            "What's the worst gift you've ever received?",
            "What's your most embarrassing autocorrect fail?",
            "What's the weirdest thing you believed as a child?",
            "What's your most cringe-worthy social media post?"
        ];
        
        // Dare challenges
        const dareChallenges = [
            "Do 20 push-ups",
            "Sing 'Happy Birthday' in opera style",
            "Dance like nobody's watching for 1 minute",
            "Speak in an accent for the next 3 rounds",
            "Do your best impression of someone in the room",
            "Tell a joke in a serious voice",
            "Act like your favorite animal for 30 seconds",
            "Do a magic trick (real or fake)",
            "Recite the alphabet backwards",
            "Do a handstand or headstand for 10 seconds",
            "Pretend to be a robot for 1 minute",
            "Make up a short rap about someone in the room",
            "Do your best runway model walk",
            "Eat something without using your hands",
            "Call someone and sing them 'Happy Birthday'",
            "Do 10 jumping jacks while singing your favorite song",
            "Act out a movie scene without speaking",
            "Try to lick your own elbow",
            "Do a cartwheel or attempt one",
            "Speak only in questions for the next 2 rounds",
            "Do your best celebrity impression",
            "Create a short commercial for an imaginary product",
            "Do a tongue twister 5 times fast",
            "Pretend to be a news anchor reporting on the party",
            "Do your worst dance moves with confidence"
        ];

        // Counting game rule options
        const countingRuleOptions = [
            {
                text: "Say 'BOOM' instead of the number 5",
                rule: "Say 'BOOM' instead of 5"
            },
            {
                text: "Clap twice before saying any number",
                rule: "Clap twice before saying numbers"
            },
            {
                text: "Stand up and spin around when saying the number 7",
                rule: "Stand and spin for number 7"
            },
            {
                text: "Say the number in a different language",
                rule: "Use different languages for numbers"
            },
            {
                text: "Say 'BANANA' instead of the number 3",
                rule: "Say 'BANANA' instead of 3"
            },
            {
                text: "Whisper every even number",
                rule: "Whisper even numbers"
            },
            {
                text: "Shout every odd number",
                rule: "Shout odd numbers"
            },
            {
                text: "Do a little dance before saying the number 6",
                rule: "Dance before saying 6"
            },
            {
                text: "Say 'MAGIC' instead of the number 9",
                rule: "Say 'MAGIC' instead of 9"
            },
            {
                text: "Touch your nose while saying the number 4",
                rule: "Touch nose while saying 4"
            },
            {
                text: "Say the number backwards (like 'owt' for 'two')",
                rule: "Say numbers backwards"
            },
            {
                text: "Make an animal sound after saying the number 8",
                rule: "Animal sound after 8"
            }
        ];

        // Find the Rule game rules
        const findRuleRules = {
            'double-letter': {
                name: 'Double Letter',
                description: 'Words must contain at least one double letter (aa, bb, cc...)',
                check: (word) => /(.)\1/.test(word.toLowerCase()),
                hint: "The words need repeated letters...",
                examples: ['effect', 'balloon', 'coffee']
            },
            'alphabet-order': {
                name: 'Alphabet Order',
                description: 'Each word must start with the next letter of the alphabet',
                check: (word, history) => {
                    if (history.length === 0) return true;
                    const lastWord = history[history.length - 1].word;
                    const lastLetter = lastWord.charAt(0).toLowerCase();
                    const currentLetter = word.charAt(0).toLowerCase();
                    const nextLetter = String.fromCharCode(lastLetter.charCodeAt(0) + 1);
                    return currentLetter === nextLetter || (lastLetter === 'z' && currentLetter === 'a');
                },
                hint: "Look at the first letter of each accepted word...",
                examples: ['apple → banana → cat → dog']
            },
            'increasing-length': {
                name: 'Increasing Length',
                description: 'Each word must have one more letter than the previous',
                check: (word, history) => {
                    if (history.length === 0) return word.length >= 3;
                    const lastWord = history[history.length - 1].word;
                    return word.length === lastWord.length + 1;
                },
                hint: "Count the letters in each word...",
                examples: ['cat (3) → dogs (4) → house (5)']
            },
            'vowel-a': {
                name: 'Contains A',
                description: 'All words must contain the letter A',
                check: (word) => word.toLowerCase().includes('a'),
                hint: "All accepted words share a common letter...",
                examples: ['cat → ball → water → GOOD']
            },
            'no-e': {
                name: 'No Letter E',
                description: 'No words can contain the letter E',
                check: (word) => !word.toLowerCase().includes('e'),
                hint: "There's one letter that all words avoid...",
                examples: ['cat → ball → sky → GOOD']
            },
            'animals': {
                name: 'Animals Only',
                description: 'All words must be animal names',
                check: (word) => {
                    const animals = ['cat', 'dog', 'bird', 'fish', 'lion', 'tiger', 'bear', 'wolf', 'fox', 'rabbit', 'mouse', 'rat', 'horse', 'cow', 'pig', 'sheep', 'goat', 'chicken', 'duck', 'goose', 'eagle', 'hawk', 'owl', 'snake', 'lizard', 'frog', 'turtle', 'whale', 'dolphin', 'shark', 'elephant', 'giraffe', 'zebra', 'monkey', 'gorilla', 'panda', 'koala', 'kangaroo', 'penguin', 'seal', 'walrus', 'deer', 'moose', 'elk', 'buffalo', 'rhino', 'hippo', 'crocodile', 'alligator'];
                    return animals.includes(word.toLowerCase());
                },
                hint: "All words belong to the same category...",
                examples: ['cat → dog → bird → fish']
            },
            'rhyme': {
                name: 'Rhymes',
                description: 'Each word must rhyme with the previous one',
                check: (word, history) => {
                    if (history.length === 0) return true;
                    const lastWord = history[history.length - 1].word.toLowerCase();
                    const currentWord = word.toLowerCase();
                    return lastWord.slice(-2) === currentWord.slice(-2) || 
                           lastWord.slice(-3) === currentWord.slice(-3);
                },
                hint: "Listen to how the words sound together...",
                examples: ['cat → bat → hat → rat']
            }
        };

        // Navigation functions
        function showGame(gameId) {
            document.querySelectorAll('.game-screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            if (gameId === 'main') {
                document.getElementById('mainMenu').classList.add('active');
            } else if (gameId === 'findRule') {
                document.getElementById('findRuleGame').classList.add('active');
            } else if (gameId === 'whoAmI') {
                document.getElementById('whoAmIGame').classList.add('active');
            } else if (gameId === 'truthDare') {
                document.getElementById('truthDareGame').classList.add('active');
            } else if (gameId === 'countingGame') {
                document.getElementById('countingGame').classList.add('active');
            }
            
            currentGame = gameId;
        }

        // Player management functions
        function addPlayer(gameType) {
            let input, players, playersList;
            
            if (gameType === 'findRule') {
                input = document.getElementById('playerName');
                players = findRulePlayers;
                playersList = 'findRulePlayersList';
            } else if (gameType === 'whoAmI') {
                input = document.getElementById('whoAmIPlayerName');
                players = whoAmIPlayers;
                playersList = 'whoAmIPlayersList';
            } else if (gameType === 'truthDare') {
                input = document.getElementById('truthDarePlayerName');
                players = truthDarePlayers;
                playersList = 'truthDarePlayersList';
            } else if (gameType === 'counting') {
                input = document.getElementById('countingPlayerName');
                players = countingPlayers;
                playersList = 'countingPlayersList';
            }
            
            const name = input.value.trim();
            if (name && !players.includes(name)) {
                players.push(name);
                if (gameType === 'findRule') {
                    findRuleScores[name] = 0;
                }
                updatePlayersDisplay(gameType, playersList);
                input.value = '';
            }
        }

        function updatePlayersDisplay(gameType, containerId) {
            const container = document.getElementById(containerId);
            let players;
            
            if (gameType === 'findRule') players = findRulePlayers;
            else if (gameType === 'whoAmI') players = whoAmIPlayers;
            else if (gameType === 'truthDare') players = truthDarePlayers;
            else if (gameType === 'counting') players = countingPlayers;
            
            container.innerHTML = players.map(player => 
                `<span class="player-tag">${player} <button class="remove-player" onclick="removePlayer('${gameType}', '${player}')">×</button></span>`
            ).join('');
        }

        function removePlayer(gameType, playerName) {
            if (gameType === 'findRule') {
                findRulePlayers = findRulePlayers.filter(p => p !== playerName);
                delete findRuleScores[playerName];
                updatePlayersDisplay('findRule', 'findRulePlayersList');
            } else if (gameType === 'whoAmI') {
                whoAmIPlayers = whoAmIPlayers.filter(p => p !== playerName);
                updatePlayersDisplay('whoAmI', 'whoAmIPlayersList');
            } else if (gameType === 'truthDare') {
                truthDarePlayers = truthDarePlayers.filter(p => p !== playerName);
                updatePlayersDisplay('truthDare', 'truthDarePlayersList');
            } else if (gameType === 'counting') {
                countingPlayers = countingPlayers.filter(p => p !== playerName);
                updatePlayersDisplay('counting', 'countingPlayersList');
            }
        }

        // FIND THE RULE GAME FUNCTIONS
        function changeGameMaster() {
            document.getElementById('ruleSelector').value = '';
            findRuleSelectedRule = null;
            alert('Game master changed! New game master should select a rule.');
        }

        function startFindRuleGame() {
            if (findRulePlayers.length < 2) {
                alert('Need at least 2 players!');
                return;
            }
            
            const ruleSelector = document.getElementById('ruleSelector');
            if (!ruleSelector.value) {
                alert('Game master must select a rule!');
                return;
            }
            
            findRuleSelectedRule = findRuleRules[ruleSelector.value];
            findRuleCurrentPlayerIndex = 0;
            findRuleHintCount = 0;
            findRuleWordHistory = [];
            
            document.getElementById('findRuleSetup').style.display = 'none';
            document.getElementById('findRuleGameplay').style.display = 'block';
            
            updateFindRuleGameDisplay();
            document.getElementById('findRuleWordInput').focus();
        }

        function updateFindRuleGameDisplay() {
            document.getElementById('findRuleCurrentPlayer').textContent = findRulePlayers[findRuleCurrentPlayerIndex];
            
            const scoresContainer = document.getElementById('findRuleScores');
            scoresContainer.innerHTML = findRulePlayers.map((player, index) => 
                `<div class="score-item ${index === findRuleCurrentPlayerIndex ? 'current-player' : ''}">
                    <span>${player}</span>
                    <span>${findRuleScores[player]} points</span>
                </div>`
            ).join('');
            
            const historyContainer = document.getElementById('findRuleWordHistory');
            historyContainer.innerHTML = findRuleWordHistory.map(item => 
                `<span class="word-item ${item.correct ? 'correct' : 'incorrect'}">${item.word}</span>`
            ).join('');
        }

        function handleFindRuleKeyPress(event) {
            if (event.key === 'Enter') {
                submitFindRuleWord();
            }
        }

        function submitFindRuleWord() {
            const input = document.getElementById('findRuleWordInput');
            const word = input.value.trim();
            if (!word) return;
            
            const isCorrect = findRuleSelectedRule.check(word, findRuleWordHistory.filter(w => w.correct));
            
            findRuleWordHistory.push({ word, correct: isCorrect, player: findRulePlayers[findRuleCurrentPlayerIndex] });
            
            if (isCorrect) {
                findRuleScores[findRulePlayers[findRuleCurrentPlayerIndex]] += 1;
                createCelebration();
            }
            
            input.value = '';
            findRuleCurrentPlayerIndex = (findRuleCurrentPlayerIndex + 1) % findRulePlayers.length;
            updateFindRuleGameDisplay();
            
            setTimeout(() => {
                document.getElementById('findRuleWordInput').focus();
            }, 100);
        }

        function giveFindRuleHint() {
            findRuleHintCount++;
            const hintBox = document.getElementById('findRuleHintBox');
            
            let hintText = findRuleSelectedRule.hint;
            if (findRuleHintCount === 2) {
                hintText += `<br><strong>Examples:</strong> ${findRuleSelectedRule.examples.join(', ')}`;
            }
            if (findRuleHintCount >= 3) {
                hintText += `<br><strong>Rule:</strong> ${findRuleSelectedRule.description}`;
            }
            
            hintBox.innerHTML = hintText;
            hintBox.classList.add('show');
        }

        function revealFindRuleRule() {
            if (confirm('Are you sure you want to reveal the rule?')) {
                alert(`The rule was: ${findRuleSelectedRule.name}\n\n${findRuleSelectedRule.description}\n\nExamples: ${findRuleSelectedRule.examples.join(', ')}`);
            }
        }

        function resetFindRuleGame() {
            if (confirm('Start a new game?')) {
                findRulePlayers = [];
                findRuleScores = {};
                findRuleWordHistory = [];
                findRuleCurrentPlayerIndex = 0;
                findRuleSelectedRule = null;
                findRuleHintCount = 0;
                
                document.getElementById('findRuleGameplay').style.display = 'none';
                document.getElementById('findRuleSetup').style.display = 'block';
                document.getElementById('findRulePlayersList').innerHTML = '';
                document.getElementById('ruleSelector').value = '';
                document.getElementById('findRuleHintBox').classList.remove('show');
            }
        }

        // WHO AM I GAME FUNCTIONS
        function startWhoAmIGame() {
            if (whoAmIPlayers.length < 2) {
                alert('Need at least 2 players!');
                return;
            }
            
            whoAmICurrentPlayerIndex = 0;
            document.getElementById('whoAmISetup').style.display = 'none';
            document.getElementById('whoAmIGameplay').style.display = 'block';
            
            setupWhoAmIRound();
        }

        function setupWhoAmIRound() {
            document.getElementById('whoAmICurrentPlayer').textContent = whoAmIPlayers[whoAmICurrentPlayerIndex];
            document.getElementById('whoAmICurrentPlayerRepeat').textContent = whoAmIPlayers[whoAmICurrentPlayerIndex];
            
            const grid = document.getElementById('characterGrid');
            grid.innerHTML = characters.map(char => 
                `<div class="character-card" onclick="selectCharacter('${char}')">${char}</div>`
            ).join('');
            
            document.getElementById('confirmCharacterBtn').style.display = 'none';
            document.getElementById('guessingPhase').style.display = 'none';
            document.getElementById('nextPlayerBtn').style.display = 'none';
            whoAmISelectedCharacter = '';
        }

        function selectCharacter(character) {
            document.querySelectorAll('.character-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            event.target.classList.add('selected');
            whoAmISelectedCharacter = character;
            document.getElementById('confirmCharacterBtn').style.display = 'block';
        }

        function confirmCharacter() {
            if (!whoAmISelectedCharacter) return;
            
            whoAmICurrentCharacter = whoAmISelectedCharacter;
            document.getElementById('guessingPlayerName').textContent = whoAmIPlayers[whoAmICurrentPlayerIndex];
            
            document.querySelector('.character-grid').parentElement.style.display = 'none';
            document.getElementById('guessingPhase').style.display = 'block';
        }

        function revealWhoAmICharacter() {
            alert(`The character was: ${whoAmICurrentCharacter}`);
            document.getElementById('nextPlayerBtn').style.display = 'block';
        }

        function whoAmICorrectGuess() {
            createCelebration();
            alert(`Congratulations! You guessed correctly: ${whoAmICurrentCharacter}`);
            document.getElementById('nextPlayerBtn').style.display = 'block';
        }

        function nextWhoAmIPlayer() {
            whoAmICurrentPlayerIndex = (whoAmICurrentPlayerIndex + 1) % whoAmIPlayers.length;
            
            document.querySelector('.character-grid').parentElement.style.display = 'block';
            setupWhoAmIRound();
        }

        function resetWhoAmIGame() {
            if (confirm('Start a new game?')) {
                whoAmIPlayers = [];
                whoAmICurrentPlayerIndex = 0;
                
                document.getElementById('whoAmIGameplay').style.display = 'none';
                document.getElementById('whoAmISetup').style.display = 'block';
                document.getElementById('whoAmIPlayersList').innerHTML = '';
            }
        }

        // TRUTH OR DARE GAME FUNCTIONS
        function startTruthDareGame() {
            if (truthDarePlayers.length < 2) {
                alert('Need at least 2 players!');
                return;
            }
            
            truthDareCurrentPlayerIndex = 0;
            document.getElementById('truthDareSetup').style.display = 'none';
            document.getElementById('truthDareGameplay').style.display = 'block';
            
            updateTruthDareDisplay();
        }

        function updateTruthDareDisplay() {
            document.getElementById('truthDareCurrentPlayer').textContent = truthDarePlayers[truthDareCurrentPlayerIndex];
            document.getElementById('truthDareQuestion').style.display = 'none';
            document.getElementById('nextTruthDareBtn').style.display = 'none';
        }

        function chooseTruth() {
            const randomTruth = truthQuestions[Math.floor(Math.random() * truthQuestions.length)];
            document.getElementById('truthDareQuestion').innerHTML = `<strong>Truth:</strong> ${randomTruth}`;
            document.getElementById('truthDareQuestion').style.display = 'block';
            document.getElementById('nextTruthDareBtn').style.display = 'block';
        }

        function chooseDare() {
            const randomDare = dareChallenges[Math.floor(Math.random() * dareChallenges.length)];
            document.getElementById('truthDareQuestion').innerHTML = `<strong>Dare:</strong> ${randomDare}`;
            document.getElementById('truthDareQuestion').style.display = 'block';
            document.getElementById('nextTruthDareBtn').style.display = 'block';
        }

        function nextTruthDarePlayer() {
            truthDareCurrentPlayerIndex = (truthDareCurrentPlayerIndex + 1) % truthDarePlayers.length;
            updateTruthDareDisplay();
        }

        function resetTruthDareGame() {
            if (confirm('Start a new game?')) {
                truthDarePlayers = [];
                truthDareCurrentPlayerIndex = 0;
                
                document.getElementById('truthDareGameplay').style.display = 'none';
                document.getElementById('truthDareSetup').style.display = 'block';
                document.getElementById('truthDarePlayersList').innerHTML = '';
            }
        }

        // COUNTING GAME FUNCTIONS
        function startCountingGame() {
            if (countingPlayers.length < 2) {
                alert('Need at least 2 players!');
                return;
            }
            
            countingCurrentPlayerIndex = 0;
            currentCount = 1;
            countingRules = ['Count from 1 to 10'];
            
            document.getElementById('countingSetup').style.display = 'none';
            document.getElementById('countingGameplay').style.display = 'block';
            
            updateCountingDisplay();
        }

        function updateCountingDisplay() {
            document.getElementById('currentNumber').textContent = currentCount;
            document.getElementById('countingCurrentPlayer').textContent = countingPlayers[countingCurrentPlayerIndex];
            
            const rulesContainer = document.getElementById('activeRules');
            rulesContainer.innerHTML = '<h4>📋 Active Rules:</h4>' + 
                countingRules.map(rule => `<div class="rule-item">${rule}</div>`).join('');
        }

        function sayNumber() {
            if (currentCount === 10) {
                createCelebration();
                showRuleSelection();
            } else {
                currentCount++;
                countingCurrentPlayerIndex = (countingCurrentPlayerIndex + 1) % countingPlayers.length;
                updateCountingDisplay();
            }
        }

        function showRuleSelection() {
            const ruleOptions = getRandomRuleOptions();
            const optionsHtml = ruleOptions.map((option, index) => 
                `<button onclick="addCountingRule('${option.rule}')" style="width: 100%; margin: 10px 0; padding: 15px; font-size: 16px;">
                    ${option.text}
                </button>`
            ).join('');
            
            document.getElementById('ruleOptions').innerHTML = optionsHtml;
            document.getElementById('ruleSelection').style.display = 'block';
        }

        function getRandomRuleOptions() {
            const shuffled = [...countingRuleOptions].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, 3);
        }

        function addCountingRule(newRule) {
            countingRules.push(newRule);
            currentCount = 1;
            countingCurrentPlayerIndex = (countingCurrentPlayerIndex + 1) % countingPlayers.length;
            
            document.getElementById('ruleSelection').style.display = 'none';
            updateCountingDisplay();
        }

        function resetCountingGame() {
            if (confirm('Start a new game?')) {
                countingPlayers = [];
                countingCurrentPlayerIndex = 0;
                currentCount = 1;
                countingRules = ['Count from 1 to 10'];
                
                document.getElementById('countingGameplay').style.display = 'none';
                document.getElementById('countingSetup').style.display = 'block';
                document.getElementById('countingPlayersList').innerHTML = '';
                document.getElementById('ruleSelection').style.display = 'none';
            }
        }

        // UTILITY FUNCTIONS
        function createCelebration() {
            const celebration = document.getElementById('celebration');
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#ffeaa7', '#fab1a0'];
            
            for (let i = 0; i < 15; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 2 + 's';
                celebration.appendChild(confetti);
                
                setTimeout(() => {
                    confetti.remove();
                }, 3000);
            }
        }

        // Event listeners for Enter key
        document.addEventListener('DOMContentLoaded', function() {
            // Find the Rule
            const playerNameInput = document.getElementById('playerName');
            if (playerNameInput) {
                playerNameInput.addEventListener('keypress', function(event) {
                    if (event.key === 'Enter') addPlayer('findRule');
                });
            }
            
            // Who Am I
            const whoAmIPlayerNameInput = document.getElementById('whoAmIPlayerName');
            if (whoAmIPlayerNameInput) {
                whoAmIPlayerNameInput.addEventListener('keypress', function(event) {
                    if (event.key === 'Enter') addPlayer('whoAmI');
                });
            }
            
            // Truth or Dare
            const truthDarePlayerNameInput = document.getElementById('truthDarePlayerName');
            if (truthDarePlayerNameInput) {
                truthDarePlayerNameInput.addEventListener('keypress', function(event) {
                    if (event.key === 'Enter') addPlayer('truthDare');
                });
            }
            
            // Counting Game
            const countingPlayerNameInput = document.getElementById('countingPlayerName');
            if (countingPlayerNameInput) {
                countingPlayerNameInput.addEventListener('keypress', function(event) {
                    if (event.key === 'Enter') addPlayer('counting');
                });
            }
        });
    </script>
</body>
</html>